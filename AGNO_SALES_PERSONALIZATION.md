# –ü–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏—è Email —Å –¥–∞–Ω–Ω—ã–º–∏ –æ –ø—Ä–æ–¥–∞–∂–∞—Ö —á–µ—Ä–µ–∑ Agno

–≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç –æ–ø–∏—Å—ã–≤–∞–µ—Ç –Ω–æ–≤—É—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö email –ø–∏—Å–µ–º —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –¥–∞–Ω–Ω—ã—Ö –æ –ø—Ä–æ–¥–∞–∂–∞—Ö –∫–æ–º–ø–∞–Ω–∏–∏ —á–µ—Ä–µ–∑ Agno + OpenRouter.

## –û–±–∑–æ—Ä —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏

–ù–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç Agno –∞–≥–µ–Ω—Ç —Å oper router –¥–ª—è:
1. –ê–Ω–∞–ª–∏–∑–∞ –¥–∞–Ω–Ω—ã—Ö –æ –ø—Ä–æ–¥–∞–∂–∞—Ö –∫–æ–º–ø–∞–Ω–∏–∏ –ø–æ–ª—É—á–∞—Ç–µ–ª—è
2. –ì–µ–Ω–µ—Ä–∞—Ü–∏–∏ –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∏–Ω—Å–∞–π—Ç–æ–≤ 
3. –°–æ–∑–¥–∞–Ω–∏—è –≤—ã—Å–æ–∫–æ –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö email –ø–∏—Å–µ–º —Å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ –∏ –º–µ—Ç—Ä–∏–∫–∞–º–∏

## –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

### 1. Pydantic –º–æ–¥–µ–ª–∏ –¥–ª—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç–∞

```python
class SalesInsight(BaseModel):
    """–ò–Ω—Å–∞–π—Ç –ø–æ –ø—Ä–æ–¥–∞–∂–∞–º –∫–æ–º–ø–∞–Ω–∏–∏"""
    metric_name: str = Field(description="–ù–∞–∑–≤–∞–Ω–∏–µ –º–µ—Ç—Ä–∏–∫–∏")
    value: str = Field(description="–ó–Ω–∞—á–µ–Ω–∏–µ –º–µ—Ç—Ä–∏–∫–∏")
    trend: str = Field(description="–¢—Ä–µ–Ω–¥ (—Ä–æ—Å—Ç/—Å–Ω–∏–∂–µ–Ω–∏–µ/—Å—Ç–∞–±–∏–ª—å–Ω–æ)")
    description: str = Field(description="–û–ø–∏—Å–∞–Ω–∏–µ –∏–Ω—Å–∞–π—Ç–∞")

class PersonalizationData(BaseModel):
    """–ü–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –ø–∏—Å—å–º–∞"""
    company_name: str
    person_name: str
    person_position: str
    total_purchases: str
    last_purchase_date: Optional[str]
    top_products: List[str]
    sales_insights: List[SalesInsight]
    recommendations: List[str]

class PersonalizedEmailContent(BaseModel):
    """–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –ø–∏—Å—å–º–∞"""
    subject: str
    body: str
    key_points: List[str]
```

### 2. Celery –∑–∞–¥–∞—á–∏

#### `generate_sales_insights_task`
–ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –¥–∞–Ω–Ω—ã–µ –æ –ø—Ä–æ–¥–∞–∂–∞—Ö –∫–æ–º–ø–∞–Ω–∏–∏ –∏ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∏–Ω—Å–∞–π—Ç—ã:

```python
# –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –æ –ø—Ä–æ–¥–∞–∂–∞—Ö –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 12 –º–µ—Å—è—Ü–µ–≤
sales_data = get_company_sales_data(company, months_back=12)

# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Agno –∞–≥–µ–Ω—Ç–∞ —Å oper router
agent = Agent(
    model=OpenRouter(
        id="openai/gpt-4o-mini",
        api_key=OPENROUTER_API_KEY,
        temperature=0.3,  # –ù–∏–∑–∫–∞—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –¥–ª—è —Ñ–∞–∫—Ç–∏—á–Ω–æ—Å—Ç–∏
        max_tokens=1500
    ),
    structured_outputs=True,
    response_model=PersonalizationData
)

# AI –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –¥–∞–Ω–Ω—ã–µ –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∏–Ω—Å–∞–π—Ç—ã
personalization_data = agent.run(prompt)
```

#### `generate_personalized_ai_email_task`
–°–æ–∑–¥–∞–µ—Ç –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ø–∏—Å—å–º–æ –∏—Å–ø–æ–ª—å–∑—É—è –∏–Ω—Å–∞–π—Ç—ã –æ –ø—Ä–æ–¥–∞–∂–∞—Ö:

```python
# –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Å–∞–π—Ç–æ–≤ –æ –ø—Ä–æ–¥–∞–∂–∞—Ö
insights_result = generate_sales_insights_task(company.id, recipient.id)

# –°–æ–∑–¥–∞–Ω–∏–µ –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –ø–∏—Å—å–º–∞
agent = Agent(
    model=OpenRouter(
        id="openai/gpt-4o-mini",
        api_key=OPENROUTER_API_KEY,
        temperature=0.7,
        max_tokens=1500
    ),
    structured_outputs=True,
    response_model=PersonalizedEmailContent
)

email_content = agent.run(personalized_prompt)
```

### 3. API Endpoints

#### `POST /api/v1/email_marketing/emails/generate_sales_insights/`
–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –∏–Ω—Å–∞–π—Ç—ã –ø–æ –ø—Ä–æ–¥–∞–∂–∞–º –∫–æ–º–ø–∞–Ω–∏–∏:

```json
{
    "company_id": 123,
    "person_id": 456
}
```

–û—Ç–≤–µ—Ç:
```json
{
    "message": "–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–Ω—Å–∞–π—Ç–æ–≤ –ø–æ –ø—Ä–æ–¥–∞–∂–∞–º –∑–∞–ø—É—â–µ–Ω–∞ —á–µ—Ä–µ–∑ Agno",
    "task_id": "abc123..."
}
```

#### `POST /api/v1/email_marketing/emails/generate_personalized/`
–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ø–∏—Å—å–º–æ —Å –¥–∞–Ω–Ω—ã–º–∏ –æ –ø—Ä–æ–¥–∞–∂–∞—Ö:

```json
{
    "recipient_id": 456,
    "context": "–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –Ω–æ–≤–æ–π –ª–∏–Ω–µ–π–∫–∏ –ø—Ä–æ–¥—É–∫—Ç–æ–≤",
    "tone": "professional",
    "purpose": "offer",
    "products": [1, 2, 3],
    "include_sales_data": true
}
```

#### `POST /api/v1/email_marketing/emails/{id}/regenerate_personalized/`
–ü–µ—Ä–µ–≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–µ –ø–∏—Å—å–º–æ —Å –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏–µ–π:

```json
{
    "context": "–û–±–Ω–æ–≤–ª–µ–Ω–Ω–æ–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ",
    "tone": "friendly",
    "purpose": "follow_up",
    "include_sales_data": true
}
```

## –ê–ª–≥–æ—Ä–∏—Ç–º —Ä–∞–±–æ—Ç—ã

1. **–ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –æ –ø—Ä–æ–¥–∞–∂–∞—Ö:**
   - –ê–Ω–∞–ª–∏–∑ —Å—á–µ—Ç–æ–≤ –ø—Ä–æ–¥–∞–∂ –∑–∞ —É–∫–∞–∑–∞–Ω–Ω—ã–π –ø–µ—Ä–∏–æ–¥ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 12 –º–µ—Å—è—Ü–µ–≤)
   - –í—ã—á–∏—Å–ª–µ–Ω–∏–µ –±–∞–∑–æ–≤—ã—Ö –º–µ—Ç—Ä–∏–∫ (–æ–±—â–∞—è —Å—É–º–º–∞, –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–æ–≤, —Å—Ä–µ–¥–Ω–∏–π —á–µ–∫)
   - –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–æ–ø-—Ç–æ–≤–∞—Ä–æ–≤ –ø–æ –æ–±—ä–µ–º—É –ø—Ä–æ–¥–∞–∂
   - –ê–Ω–∞–ª–∏–∑ —Ç—Ä–µ–Ω–¥–æ–≤ (—Å—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –ø—Ä–µ–¥—ã–¥—É—â–∏–º –ø–µ—Ä–∏–æ–¥–æ–º)

2. **AI –∞–Ω–∞–ª–∏–∑ —á–µ—Ä–µ–∑ Agno:**
   - –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø—Ä–æ–º–ø—Ç —Å –¥–∞–Ω–Ω—ã–º–∏ –æ –∫–æ–º–ø–∞–Ω–∏–∏ –∏ –ø—Ä–æ–¥–∞–∂–∞—Ö
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ oper router –¥–ª—è –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏
   - –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–Ω—Å–∞–π—Ç–æ–≤ —Å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º–∏ —Ü–∏—Ñ—Ä–∞–º–∏ –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è–º–∏

3. **–°–æ–∑–¥–∞–Ω–∏–µ –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –ø–∏—Å—å–º–∞:**
   - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –∏–Ω—Å–∞–π—Ç–æ–≤ –æ –ø—Ä–æ–¥–∞–∂–∞—Ö –≤ –ø—Ä–æ–º–ø—Ç
   - –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø–∏—Å—å–º–∞ —Å —É—á–µ—Ç–æ–º –¥–æ–ª–∂–Ω–æ—Å—Ç–∏ –ø–æ–ª—É—á–∞—Ç–µ–ª—è
   - –í–∫–ª—é—á–µ–Ω–∏–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö —Ñ–∞–∫—Ç–æ–≤ –∏ —Ü–∏—Ñ—Ä –¥–ª—è —É–±–µ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

## –ü—Ä–∏–º–µ—Ä –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –ø–∏—Å—å–º–∞

**–¢–µ–º–∞:** "–ê–Ω–∞–ª–∏–∑ –≤–∞—à–∏—Ö –ø–æ–∫—É–ø–æ–∫ –∏ –Ω–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –¥–ª—è –¢–µ—Ö–ö–æ–º"

**–¢–µ–∫—Å—Ç:**
```
–î–æ–±—Ä—ã–π –¥–µ–Ω—å, –ò–≤–∞–Ω –ü–µ—Ç—Ä–æ–≤–∏—á!

–ò–∑—É—á–∏–≤ –∏—Å—Ç–æ—Ä–∏—é –Ω–∞—à–∏—Ö –ø–æ—Å—Ç–∞–≤–æ–∫ –¥–ª—è –¢–µ—Ö–ö–æ–º –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–π –≥–æ–¥, —Ö–æ—á—É –ø–æ–¥–µ–ª–∏—Ç—å—Å—è –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã–º–∏ –Ω–∞–±–ª—é–¥–µ–Ω–∏—è–º–∏:

üìä –í–∞—à–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∑–∞ 2024 –≥–æ–¥:
‚Ä¢ –û–±—â–∏–π –æ–±—ä–µ–º –∑–∞–∫—É–ø–æ–∫: 2 450 000 ‚ÇΩ (+15% –∫ –ø—Ä–æ—à–ª–æ–º—É –≥–æ–¥—É)
‚Ä¢ –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–æ–≤: 18 (—Å—Ç–∞–±–∏–ª—å–Ω—ã–π —Ä–æ—Å—Ç)
‚Ä¢ –°—Ä–µ–¥–Ω–∏–π —á–µ–∫: 136 111 ‚ÇΩ

üîù –í–∞—à–∏ —Ç–æ–ø-–ø–æ–∑–∏—Ü–∏–∏:
‚Ä¢ –°–µ—Ä–≤–µ—Ä–Ω–æ–µ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ HP: 45% –æ—Ç –æ–±—â–µ–≥–æ –æ–±—ä–µ–º–∞
‚Ä¢ –°–∏—Å—Ç–µ–º—ã —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö: 28% 
‚Ä¢ –°–µ—Ç–µ–≤–æ–µ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ: 19%

–ö–∞–∫ –¥–∏—Ä–µ–∫—Ç–æ—Ä –ø–æ IT, –≤—ã –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç–µ –æ—Ç–ª–∏—á–Ω–æ–µ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–∫—É–ø–æ–∫. –û—Å–æ–±–µ–Ω–Ω–æ –≤–ø–µ—á–∞—Ç–ª—è–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω—ã–π —Ä–æ—Å—Ç –≤ —Å–µ–≥–º–µ–Ω—Ç–µ —Å–µ—Ä–≤–µ—Ä–æ–≤ - —ç—Ç–æ –≥–æ–≤–æ—Ä–∏—Ç –æ —Ä–∞–∑–≤–∏—Ç–∏–∏ –≤–∞—à–µ–π –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã.

–£—á–∏—Ç—ã–≤–∞—è –≤–∞—à —Ñ–æ–∫—É—Å –Ω–∞ —Å–µ—Ä–≤–µ—Ä–Ω–æ–º –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–∏, –ø—Ä–µ–¥–ª–∞–≥–∞—é –æ–±—Å—É–¥–∏—Ç—å –Ω–æ–≤—É—é –ª–∏–Ω–µ–π–∫—É HP ProLiant Gen11 - –æ–Ω–∞ –º–æ–∂–µ—Ç —Å–Ω–∏–∑–∏—Ç—å –≤–∞—à–∏ —Ä–∞—Å—Ö–æ–¥—ã –Ω–∞ —ç–Ω–µ—Ä–≥–æ–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ –¥–æ 25%.

–ì–æ—Ç–æ–≤ –≤—Å—Ç—Ä–µ—Ç–∏—Ç—å—Å—è –Ω–∞ —ç—Ç–æ–π –Ω–µ–¥–µ–ª–µ –¥–ª—è –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏–∏ —Ä–µ—à–µ–Ω–∏–π, –∫–æ—Ç–æ—Ä—ã–µ —Ç–æ—á–Ω–æ –ø–æ–¥–æ–π–¥—É—Ç –¢–µ—Ö–ö–æ–º.

–° —É–≤–∞–∂–µ–Ω–∏–µ–º,
–ê–ª–µ–∫—Å–µ–π –°–º–∏—Ä–Ω–æ–≤
Sales Manager
```

## –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã

1. **–í—ã—Å–æ–∫–∞—è –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏—è:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –æ –ø–æ–∫—É–ø–∫–∞—Ö
2. **–§–∞–∫—Ç–∏—á–µ—Å–∫–∞—è –±–∞–∑–∞:** –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Ü–∏—Ñ—Ä—ã –∏ —Ç—Ä–µ–Ω–¥—ã –≤–º–µ—Å—Ç–æ –æ–±—â–∏—Ö —Ñ—Ä–∞–∑
3. **–†–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç—å:** –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –æ—Å–Ω–æ–≤–∞–Ω—ã –Ω–∞ –∏—Å—Ç–æ—Ä–∏–∏ –ø–æ–∫—É–ø–æ–∫
4. **–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:** –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è —ç–∫—Å–ø–µ—Ä—Ç–Ω–æ—Å—Ç–∏ —á–µ—Ä–µ–∑ –∞–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö
5. **–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Å –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–º —É—á–∞—Å—Ç–∏–µ–º –º–µ–Ω–µ–¥–∂–µ—Ä–∞

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

1. **–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω OPENROUTER_API_KEY –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è**
2. **–ê–≥–Ω–æ —É–∂–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤ –ø—Ä–æ–µ–∫—Ç–µ (–≤–µ—Ä—Å–∏—è 1.7.7+)**
3. **–ù–æ–≤—ã–µ –∑–∞–¥–∞—á–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç –æ—á–µ—Ä–µ–¥—å RABBITMQ_EMAIL_QUEUE**

### –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ –∫–æ–¥–µ:

```python
from email_marketing.tasks import generate_personalized_ai_email_task

# –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –ø–∏—Å—å–º–∞
result = generate_personalized_ai_email_task.delay(
    user_id=manager_id,
    recipient_id=person_id,
    context="–ù–æ–≤—ã–µ —Ä–µ—à–µ–Ω–∏—è –¥–ª—è –≤–∞—à–µ–π –æ—Ç—Ä–∞—Å–ª–∏",
    tone="professional",
    purpose="offer",
    products=[1, 2, 3],
    include_sales_data=True
)
```

## –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –æ—Ç–ª–∞–¥–∫–∞

- –í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è —Å –ø–æ–¥—Ä–æ–±–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π
- –°—Ç–∞—Ç—É—Å –∑–∞–¥–∞—á –º–æ–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —á–µ—Ä–µ–∑ endpoint `task_status`
- –ü—Ä–∏ –æ—à–∏–±–∫–∞—Ö –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è –¥–µ—Ç–∞–ª—å–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è graceful degradation (–ø–∏—Å—å–º–æ —Å–æ–∑–¥–∞–µ—Ç—Å—è –¥–∞–∂–µ –±–µ–∑ –¥–∞–Ω–Ω—ã—Ö –æ –ø—Ä–æ–¥–∞–∂–∞—Ö)

## –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è prefetch_related –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ –ë–î
- –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –¥–ª—è —á–∞—Å—Ç–æ –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ–º—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- –ê–≥–Ω–æ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å oper router –¥–ª—è –º–∏–Ω–∏–º–∏–∑–∞—Ü–∏–∏ –∑–∞—Ç—Ä–∞—Ç –Ω–∞ API

–≠—Ç–∞ —Å–∏—Å—Ç–µ–º–∞ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –ø–æ–≤—ã—à–∞–µ—Ç –∫–∞—á–µ—Å—Ç–≤–æ –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏–∏ email —Ä–∞—Å—Å—ã–ª–æ–∫ –∏ –∫–æ–Ω–≤–µ—Ä—Å–∏—é —á–µ—Ä–µ–∑ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –æ –ø—Ä–æ–¥–∞–∂–∞—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤.